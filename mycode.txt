from selenium.webdriver.support.ui import WebDriverWait, Select
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
import time

# Step 1: Select "é€æ—¥ç›¯å¸‚" (Mark-to-Market)
select_element = Select(driver.find_element(By.NAME, "byType"))
select_element.select_by_value("date")  # or .select_by_index(0)

# Step 2: Click the submit button (æäº¤)
submit_button = driver.find_element(By.CSS_SELECTOR, "input.button[value='æäº¤']")
submit_button.click()

# Step 3: Wait for the "ä¸‹è½½" (Download) link and click it
wait = WebDriverWait(driver, 10)
download_link = wait.until(EC.element_to_be_clickable((By.ID, "myDownload")))
download_link.click()
print("âœ… Download clicked.")

# Step 4: Wait a moment for download to start
time.sleep(2)  # Adjust if needed

# Step 5: Click the logout button ("é€€å‡ºç³»ç»Ÿ")
logout_button = driver.find_element(By.CSS_SELECTOR, "input.button[name='logout']")
logout_button.click()
print("ğŸ‘‹ Logged out successfully.")
